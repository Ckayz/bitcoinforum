(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{6023:function(e,s,t){Promise.resolve().then(t.bind(t,5485))},5485:function(e,s,t){"use strict";t.r(s),t.d(s,{ClientThreadPage:function(){return y}});var a=t(7437),i=t(2265),n=t(4033),r=t(1396),l=t.n(r),c=t(6110),d=t(3023),o=t(5771),x=t(3067),m=t(4116),h=t(7972),u=t(6141),f=t(2882),g=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,g.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var j=t(6763),N=t(1349),v=t(9210),b=t(7404),w=t(9246);function y(e){var s,t,r,g;let{threadId:y}=e;(0,n.useRouter)();let{user:z}=(0,N.a)(),[k,_]=(0,i.useState)(null),[Z,C]=(0,i.useState)([]),[S,O]=(0,i.useState)(!0),[R,P]=(0,i.useState)(!1),[D,E]=(0,i.useState)(""),[B,T]=(0,i.useState)(!1);(0,i.useEffect)(()=>{y&&q()},[y]);let q=async()=>{try{console.log("Fetching thread and posts for ID:",y);let{data:e,error:s}=await j.O.from("threads").select("\n          id,\n          title,\n          created_at,\n          user_id,\n          category_id,\n          categories (name),\n          users (username)\n        ").eq("id",y).single();if(s)throw console.error("Thread error:",s),s;console.log("Thread data:",e),_(e);let{data:t,error:a}=await j.O.from("posts").select("\n          id,\n          content,\n          created_at,\n          user_id,\n          users (username),\n          likes (id, user_id)\n        ").eq("thread_id",y).order("created_at",{ascending:!0});if(a)throw console.error("Posts error:",a),a;console.log("Posts data:",t),C(t||[])}catch(e){console.error("Error fetching data:",e)}finally{O(!1)}},Y=async e=>{if(e.preventDefault(),z&&k){T(!0);try{let{error:e}=await j.O.from("posts").insert([{thread_id:k.id,user_id:z.id,content:D}]);if(e)throw e;E(""),q()}catch(e){console.error("Error creating post:",e)}finally{T(!1)}}},U=async e=>{if(!z){P(!0);return}try{let s=Z.find(s=>s.id===e),t=null==s?void 0:s.likes.some(e=>e.user_id===z.id);if(t){let{error:s}=await j.O.from("likes").delete().eq("post_id",e).eq("user_id",z.id);if(s)throw s}else{let{error:s}=await j.O.from("likes").insert([{post_id:e,user_id:z.id}]);if(s)throw s}q()}catch(e){console.error("Error toggling like:",e)}};return S?(0,a.jsxs)("div",{className:"min-h-screen bg-zinc-950",children:[(0,a.jsx)(b.w,{}),(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,a.jsx)("div",{className:"h-8 bg-zinc-800 rounded w-1/3"}),(0,a.jsx)("div",{className:"h-4 bg-zinc-800 rounded w-2/3"}),(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"h-32 bg-zinc-800 rounded"},s))})]})})]}):k?(0,a.jsxs)("div",{className:"min-h-screen bg-zinc-950",children:[(0,a.jsx)(b.w,{}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"flex items-center space-x-4 mb-6",children:(0,a.jsx)(l(),{href:"/category/".concat(k.category_id),children:(0,a.jsxs)(d.z,{variant:"outline",size:"sm",className:"border-zinc-700 text-gray-300 hover:bg-zinc-800",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Back to ",null===(t=k.categories)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.name]})})}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(m.Z,{className:"h-8 w-8 text-orange-500"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:k.title})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Started by ",(null===(g=k.users)||void 0===g?void 0:null===(r=g[0])||void 0===r?void 0:r.username)||"Unknown User"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:(0,w.Z)(new Date(k.created_at),{addSuffix:!0})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[Z.length," posts"]})]})]})]}),(0,a.jsx)("div",{className:"space-y-6 mb-8",children:Z.map((e,s)=>{var t,i;return(0,a.jsx)(c.Zb,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsxs)(c.aY,{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(h.Z,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold text-white",children:(null===(i=e.users)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.username)||"Unknown User"}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:[0===s?"Original Post":"Post #".concat(s+1)," â€¢ ",(0,w.Z)(new Date(e.created_at),{addSuffix:!0})]})]})]})}),(0,a.jsx)("div",{className:"text-gray-200 mb-4 whitespace-pre-wrap",children:e.content}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:()=>U(e.id),className:"text-gray-400 hover:text-red-500 ".concat(e.likes.some(e=>e.user_id===(null==z?void 0:z.id))?"text-red-500":""),children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-1"}),e.likes.length]})})]})},e.id)})}),(0,a.jsxs)(c.Zb,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{className:"text-white",children:"Reply to Thread"}),(0,a.jsx)(c.SZ,{className:"text-gray-300",children:"Share your thoughts on this discussion"})]}),(0,a.jsx)(c.aY,{children:z?(0,a.jsxs)("form",{onSubmit:Y,className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)(o.g,{placeholder:"What are your thoughts?",value:D,onChange:e=>E(e.target.value),required:!0,rows:5,className:"bg-zinc-800 border-zinc-700 text-white focus:border-orange-500"})}),(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)(d.z,{type:"submit",disabled:B,className:"bg-orange-500 hover:bg-orange-600 text-white",children:B?"Posting...":"Post Reply"})})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-300 mb-4",children:"You need to be logged in to reply to this thread."}),(0,a.jsx)(d.z,{onClick:()=>{if(!z){P(!0);return}},className:"bg-orange-500 hover:bg-orange-600 text-white",children:"Login to Reply"})]})})]})]}),(0,a.jsx)(v.j,{isOpen:R,onClose:()=>P(!1),action:"Login to participate in Bitcoin discussions"})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-zinc-950",children:[(0,a.jsx)(b.w,{}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"Thread Not Found"}),(0,a.jsx)(l(),{href:"/",children:(0,a.jsx)(d.z,{className:"bg-orange-500 hover:bg-orange-600 text-white",children:"Back to Home"})})]})]})}},9210:function(e,s,t){"use strict";t.d(s,{j:function(){return N}});var a=t(7437),i=t(3023),n=t(2265),r=t(9200),l=t(2549),c=t(9311);let d=r.fC;r.xz;let o=r.h_;r.x8;let x=n.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(r.aV,{ref:s,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...i})});x.displayName=r.aV.displayName;let m=n.forwardRef((e,s)=>{let{className:t,children:i,...n}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(r.VY,{ref:s,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[i,(0,a.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=r.VY.displayName;let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};h.displayName="DialogHeader";let u=n.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(r.Dx,{ref:s,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",t),...i})});u.displayName=r.Dx.displayName;let f=n.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(r.dk,{ref:s,className:(0,c.cn)("text-sm text-muted-foreground",t),...i})});f.displayName=r.dk.displayName;var g=t(4116),p=t(1396),j=t.n(p);function N(e){let{isOpen:s,onClose:t,action:n}=e;return(0,a.jsx)(d,{open:s,onOpenChange:t,children:(0,a.jsxs)(m,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsxs)(h,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(g.Z,{className:"h-6 w-6 text-orange-500"}),(0,a.jsx)(u,{className:"text-white",children:"Join the Bitcoin Community"})]}),(0,a.jsxs)(f,{className:"text-gray-300",children:[n," to participate in Bitcoin discussions and connect with fellow Bitcoiners."]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-3 mt-4",children:[(0,a.jsx)(j(),{href:"/auth/signup",onClick:t,children:(0,a.jsx)(i.z,{className:"w-full bg-orange-500 hover:bg-orange-600 text-white",children:"Create Account"})}),(0,a.jsx)(j(),{href:"/auth/login",onClick:t,children:(0,a.jsx)(i.z,{variant:"outline",className:"w-full border-zinc-700 text-gray-300 hover:bg-zinc-800",children:"Sign In"})})]})]})})}},5771:function(e,s,t){"use strict";t.d(s,{g:function(){return r}});var a=t(7437),i=t(2265),n=t(9311);let r=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});r.displayName="Textarea"}},function(e){e.O(0,[231,190,614,971,864,744],function(){return e(e.s=6023)}),_N_E=e.O()}]);